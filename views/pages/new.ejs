<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add New Lepak Corner</title>
    <script src="https://maps.googleapis.com/maps/api/js?key=<%= googleApiKey %>&libraries=places"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"/>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
<main class="container">
    <!-- Navbar -->
    <%- include('../partials/navbar'); %>

    <div class="welcome-container">
        <h1>Add a New Lepak Corner</h1>
        <h2>Start with where to find it...</h2>
    </div>

    <div class="create-post-container">
        <form method="post" id="createPostForm">
            <fieldset>
                <label>
                    Location
                    <input 
                        type="text" 
                        id="autocomplete" 
                        placeholder="Enter an address" 
                        name="name" 
                        required
                    />
                </label>
            </fieldset>

            <label>
                Description
                <textarea name="description" placeholder="Talk about it..." required></textarea>
            </label>

            <!-- Hidden input to store place ID (or additional data if needed) -->
            <input type="hidden" id="placeIdInput" name="placeId"/>

            <input
                type="submit"
                value="ðŸš€ Add Lepak Corner"
            />
        </form>
    </div>

    <div class="cancel-create-post">
        <a href="/">Cancel! Let me look around.</a>
    </div>
</main>

<script>
    let autocomplete;

    function initAutocomplete() {
        // Initialize the autocomplete object, restricting the search to geocode (address) types.
        const input = document.getElementById('autocomplete');

        const autocomplete = new google.maps.places.Autocomplete(input, {
        types: ["geocode"], // Only allow address-like results
        componentRestrictions: { country: "SG" }, // Restrict to Singapore
      });

        // Optionally listen for place selection event
        autocomplete.addListener("place_changed", () => {
          const place = autocomplete.getPlace();
          console.log("Selected Place:", place);
        });
    }

    function handlePlaceSelect() {
        const place = autocomplete.getPlace();

        // Populate the hidden input with the place ID or other desired data
        if (place && place.place_id) {
            document.getElementById('placeIdInput').value = place.place_id;
        } else {
            console.error('No place details available');
        }
    }

    // Initialize the Autocomplete when the page loads
    document.addEventListener('DOMContentLoaded', initAutocomplete);
</script>
</body>
</html>
